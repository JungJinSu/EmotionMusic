library(KoNLP)
library(wordcloud)
library(Ruchardet)


useSejongDic()

# 사전에 없는 단어 추가
buildDictionary()


sam_1_v <- readLines("lyrics.txt", encoding = detectFileEncoding("lyrics.txt"))


# 각 줄에서 단어만 남기기
data = sapply(sam_1_v, extractNoun, USE.NAMES = F)


undata = unlist(data)



# undata = SimplePos09(undata)


# 2글자 이상 단어만
data = Filter(function(x){nchar(x)>=2},undata)


# 필터
data = gsub('\\d+',"",data) # 숫자 제거
data = gsub('\\.',"",data) # 점(.) 제거

data = gsub("\n", "", data)
data = gsub("\r", "", data)

data = gsub("Yo", "", data)
data = gsub("in", "", data)
data = gsub("is", "", data)
data = gsub("of", "", data)
data = gsub("to", "", data)
data = gsub("it", "", data)
data = gsub("ll", "", data)
data = gsub("IT", "", data)
data = gsub("day", "", data)
data = gsub("니가", "", data)
data = gsub("up", "", data)
data = gsub("is", "", data)
data = gsub("그대", "", data)
data = gsub("세상", "", data)
data = gsub("and", "", data)
data = gsub("my", "", data)
data = gsub("생각", "", data)
data = gsub("기억", "", data)
data = gsub("오늘", "", data)
data = gsub("Ks", "", data)
data = gsub("away", "", data)
data = gsub("모습", "", data)
data = gsub("Let", "", data)
data = gsub("show", "", data)
data = gsub("하나", "", data)
data = gsub("Burn", "", data)
data = gsub("now", "", data)
data = gsub("시간", "", data)
data = gsub("하게", "", data)
data = gsub("가슴", "", data)
data = gsub("baby", "", data)
data = gsub("md", "", data)
data = gsub("that", "", data)
data = gsub("무엇", "", data)
data = gsub("say", "", data)
data = gsub("하늘", "", data)
data = gsub("re", "", data)
data = gsub("모두", "", data)
data = gsub("때문", "", data)
data = gsub("get", "", data)
data = gsub("so", "", data)
data = gsub("u", "", data)
data = gsub("let", "", data)
data = gsub("life", "", data)
data = gsub("SE", "", data)
data = gsub("클레", "", data)
data = gsub("Dtraction", "", data)
data = gsub("just", "", data)
data = gsub("sgg", "", data)
data = gsub("내겐", "", data)
data = gsub("member", "", data)
data = gsub("mo", "", data)
data = gsub("on", "", data)
data = gsub("rap", "", data)
data = gsub("김경", "", data)
data = gsub("꽈리", "", data)
data = gsub("be", "", data)
data = gsub("랏밥", "", data)
data = gsub("거예요", "", data)
data = gsub("Rn", "", data)
data = gsub("영화", "", data)
data = gsub("The", "", data)
data = gsub("K", "", data)
data = gsub("d", "", data)
data = gsub("ale", "", data)
data = gsub("th", "", data)

data = gsub("", "", data)
data = gsub("", "", data)
data = gsub("", "", data)
data = gsub("", "", data)
data = gsub("", "", data)





write(unlist(data),"new_data.txt")

table_data = read.table("new_data.txt")

wordcount = table(table_data)




wordcloud(names(wordcount),freq=wordcount,scale=c(5,1),
          rot.per=0.25,min.freq=1,random.order=F,random.color=T,
          colors=brewer.pal(9,"Set1"))

wordcont = sort(wordcount,decreasing = T)

head(wordcont,n=200)



